<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Example - NeoForge Component Library</title>

  <!-- Global styles -->
  <link rel="stylesheet" href="../styles/global.css">

  <!-- Component imports -->
  <script type="module" src="../components/organisms/dashboard-layout.js"></script>
  <script type="module" src="../components/organisms/notification-list.js"></script>
  <script type="module" src="../components/organisms/table/table.js"></script>
  <script type="module" src="../components/molecules/input-field/input-field.js"></script>
  <script type="module" src="../components/molecules/select-dropdown/select-dropdown.js"></script>
  <script type="module" src="../components/molecules/cta-button-row/cta-button-row.js"></script>
  <script type="module" src="../components/atoms/button/button.js"></script>
  <script type="module" src="../components/atoms/badge/badge.js"></script>

  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    .dashboard-content {
      padding: 0;
      height: 100%;
    }

    .content-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 1.5rem;
      height: calc(100vh - 120px);
    }

    .main-panel {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .side-panel {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 1.5rem;
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .card-title {
      font-size: 1.125rem;
      font-weight: 600;
      margin: 0;
      color: #1f2937;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .stat-card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 1rem;
      text-align: center;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: #3b82f6;
      margin: 0;
    }

    .stat-label {
      font-size: 0.875rem;
      color: #6b7280;
      margin: 0.25rem 0 0 0;
    }

    .quick-actions {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    @media (max-width: 768px) {
      .content-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }

      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>
<body>
  <neo-dashboard-layout
    id="dashboard"
    logo-text="NeoForge"
    show-search
    show-notifications
    notification-count="3">

    <span slot="page-title">Dashboard Overview</span>

    <div class="dashboard-content">
      <!-- Stats Overview -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value">2,547</div>
          <div class="stat-label">Total Users</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">$12,847</div>
          <div class="stat-label">Revenue</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">847</div>
          <div class="stat-label">Active Sessions</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">98.2%</div>
          <div class="stat-label">Uptime</div>
        </div>
      </div>

      <!-- Main Content Grid -->
      <div class="content-grid">
        <!-- Main Panel -->
        <div class="main-panel">
          <!-- Recent Users Table -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Recent Users</h2>
              <div class="quick-actions">
                <neo-button variant="outline" size="sm">Export</neo-button>
                <neo-button variant="primary" size="sm">Add User</neo-button>
              </div>
            </div>

            <neo-table
              id="usersTable"
              selectable
              sortable
              searchable>
            </neo-table>
          </div>

          <!-- Quick Actions Form -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Quick Actions</h2>
            </div>

            <form id="quickActionForm">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                <neo-input-field
                  label="User Name"
                  name="userName"
                  placeholder="Enter user name"
                  required>
                </neo-input-field>

                <neo-select-dropdown
                  label="Role"
                  name="role"
                  placeholder="Select role"
                  searchable>
                </neo-select-dropdown>
              </div>

              <neo-cta-button-row
                alignment="right"
                id="formActions">
              </neo-cta-button-row>
            </form>
          </div>
        </div>

        <!-- Side Panel -->
        <div class="side-panel">
          <!-- Notifications -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Recent Activity</h2>
              <neo-badge variant="primary" size="sm">3 new</neo-badge>
            </div>

            <neo-notification-list
              id="notifications"
              group-by-date
              show-actions
              show-avatars
              max-height="400">
            </neo-notification-list>
          </div>

          <!-- System Status -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">System Status</h2>
              <neo-badge variant="success" size="sm">All Systems Operational</neo-badge>
            </div>

            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>API Server</span>
                <neo-badge variant="success" size="sm">Online</neo-badge>
              </div>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>Database</span>
                <neo-badge variant="success" size="sm">Online</neo-badge>
              </div>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>Cache</span>
                <neo-badge variant="warning" size="sm">Degraded</neo-badge>
              </div>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>CDN</span>
                <neo-badge variant="success" size="sm">Online</neo-badge>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </neo-dashboard-layout>

  <script type="module">
    // Dashboard setup
    const dashboard = document.getElementById('dashboard');

    // Configure dashboard
    dashboard.user = {
      name: 'John Doe',
      email: 'john.doe@example.com',
      avatar: 'https://ui-avatars.com/api/?name=John+Doe&background=3b82f6&color=fff',
      role: 'Administrator',
      status: 'online'
    };

    dashboard.navigationItems = [
      {
        href: '/dashboard',
        text: 'Dashboard',
        icon: 'home',
        active: true
      },
      {
        href: '/users',
        text: 'Users',
        icon: 'users',
        badge: '247'
      },
      {
        href: '/analytics',
        text: 'Analytics',
        icon: 'bar-chart'
      },
      {
        href: '/settings',
        text: 'Settings',
        icon: 'settings'
      },
      {
        href: '/help',
        text: 'Help & Support',
        icon: 'help-circle',
        badge: '2',
        badgeVariant: 'warning'
      }
    ];

    dashboard.quickActions = [
      { icon: 'plus', title: 'Add New', text: 'Add New' },
      { icon: 'download', title: 'Export Data', text: 'Export' },
      { icon: 'refresh-cw', title: 'Refresh', text: 'Refresh' }
    ];

    // Configure users table
    const usersTable = document.getElementById('usersTable');
    usersTable.columns = [
      {
        key: 'name',
        title: 'Name',
        sortable: true,
        type: 'avatar'
      },
      {
        key: 'email',
        title: 'Email',
        sortable: true
      },
      {
        key: 'role',
        title: 'Role',
        type: 'badge'
      },
      {
        key: 'status',
        title: 'Status',
        type: 'badge'
      },
      {
        key: 'lastSeen',
        title: 'Last Seen',
        sortable: true,
        type: 'date'
      },
      {
        key: 'actions',
        title: 'Actions',
        type: 'actions'
      }
    ];

    usersTable.data = [
      {
        id: '1',
        name: { name: 'Alice Johnson', avatar: 'https://ui-avatars.com/api/?name=Alice+Johnson&background=10b981&color=fff' },
        email: 'alice@example.com',
        role: { text: 'Admin', variant: 'error' },
        status: { text: 'Online', variant: 'success' },
        lastSeen: new Date(Date.now() - 1000 * 60 * 5).toISOString(),
        actions: [
          { icon: 'edit', action: 'edit' },
          { icon: 'trash', action: 'delete' }
        ]
      },
      {
        id: '2',
        name: { name: 'Bob Smith', avatar: 'https://ui-avatars.com/api/?name=Bob+Smith&background=f59e0b&color=fff' },
        email: 'bob@example.com',
        role: { text: 'User', variant: 'secondary' },
        status: { text: 'Away', variant: 'warning' },
        lastSeen: new Date(Date.now() - 1000 * 60 * 15).toISOString(),
        actions: [
          { icon: 'edit', action: 'edit' },
          { icon: 'trash', action: 'delete' }
        ]
      },
      {
        id: '3',
        name: { name: 'Carol Davis', avatar: 'https://ui-avatars.com/api/?name=Carol+Davis&background=ef4444&color=fff' },
        email: 'carol@example.com',
        role: { text: 'Moderator', variant: 'warning' },
        status: { text: 'Offline', variant: 'neutral' },
        lastSeen: new Date(Date.now() - 1000 * 60 * 60 * 2).toISOString(),
        actions: [
          { icon: 'edit', action: 'edit' },
          { icon: 'trash', action: 'delete' }
        ]
      }
    ];

    usersTable.bulkActions = [
      { id: 'delete', text: 'Delete Selected', variant: 'error' },
      { id: 'export', text: 'Export Selected', variant: 'outline' }
    ];

    // Configure role dropdown
    const roleSelect = document.querySelector('neo-select-dropdown[name="role"]');
    roleSelect.options = [
      { value: 'admin', label: 'Administrator' },
      { value: 'moderator', label: 'Moderator' },
      { value: 'user', label: 'User' },
      { value: 'guest', label: 'Guest' }
    ];

    // Configure form actions
    const formActions = document.getElementById('formActions');
    formActions.actions = [
      {
        id: 'reset',
        text: 'Reset',
        variant: 'outline',
        type: 'reset'
      },
      {
        id: 'save',
        text: 'Create User',
        variant: 'primary',
        type: 'submit',
        primary: true
      }
    ];

    // Configure notifications
    const notifications = document.getElementById('notifications');
    notifications.notifications = [
      {
        id: '1',
        title: 'New User Registration',
        message: 'Alice Johnson has joined your organization',
        type: 'info',
        timestamp: new Date(Date.now() - 1000 * 60 * 5).toISOString(),
        read: false,
        user: {
          name: 'Alice Johnson',
          avatar: 'https://ui-avatars.com/api/?name=Alice+Johnson&background=10b981&color=fff'
        }
      },
      {
        id: '2',
        title: 'System Update',
        message: 'System maintenance completed successfully',
        type: 'success',
        timestamp: new Date(Date.now() - 1000 * 60 * 30).toISOString(),
        read: false,
        user: {
          name: 'System',
          avatar: 'https://ui-avatars.com/api/?name=System&background=6b7280&color=fff'
        }
      },
      {
        id: '3',
        title: 'Performance Alert',
        message: 'Cache server response time is above normal',
        type: 'warning',
        timestamp: new Date(Date.now() - 1000 * 60 * 60).toISOString(),
        read: true,
        user: {
          name: 'Monitoring',
          avatar: 'https://ui-avatars.com/api/?name=Monitor&background=f59e0b&color=fff'
        }
      }
    ];

    notifications.bulkActions = [
      { id: 'mark-read', text: 'Mark as Read', variant: 'outline' },
      { id: 'delete', text: 'Delete', variant: 'error' }
    ];

    // Event handlers
    dashboard.addEventListener('neo-dashboard-navigate', (e) => {
      console.log('Navigation:', e.detail);
      // Handle navigation
    });

    dashboard.addEventListener('neo-dashboard-search', (e) => {
      console.log('Search:', e.detail);
      // Handle search
    });

    dashboard.addEventListener('neo-dashboard-notification-click', (e) => {
      console.log('Notifications clicked');
      // Handle notification panel toggle
    });

    dashboard.addEventListener('neo-dashboard-user-menu', (e) => {
      console.log('User menu action:', e.detail);
      // Handle user menu actions
    });

    usersTable.addEventListener('neo-table-row-click', (e) => {
      console.log('User row clicked:', e.detail.row);
      // Navigate to user details
    });

    usersTable.addEventListener('neo-table-bulk-action', (e) => {
      console.log('Bulk action:', e.detail);
      // Handle bulk actions
    });

    notifications.addEventListener('neo-notification-click', (e) => {
      console.log('Notification clicked:', e.detail.notification);
      // Handle notification click
    });

    notifications.addEventListener('neo-bulk-action', (e) => {
      console.log('Notification bulk action:', e.detail);
      // Handle notification bulk actions
    });

    // Form handling
    const form = document.getElementById('quickActionForm');
    formActions.addEventListener('neo-action-click', (e) => {
      const { action } = e.detail;

      if (action.id === 'save') {
        const formData = new FormData(form);
        const userData = {
          userName: formData.get('userName'),
          role: formData.get('role')
        };

        console.log('Creating user:', userData);

        // Add to table
        const newUser = {
          id: Date.now().toString(),
          name: { name: userData.userName, avatar: `https://ui-avatars.com/api/?name=${encodeURIComponent(userData.userName)}&background=random` },
          email: `${userData.userName.toLowerCase().replace(/\s+/g, '.')}@example.com`,
          role: { text: userData.role, variant: 'secondary' },
          status: { text: 'Online', variant: 'success' },
          lastSeen: new Date().toISOString(),
          actions: [
            { icon: 'edit', action: 'edit' },
            { icon: 'trash', action: 'delete' }
          ]
        };

        usersTable.data = [...usersTable.data, newUser];
        form.reset();

        // Show success notification
        const newNotification = {
          id: Date.now().toString(),
          title: 'User Created',
          message: `Successfully created user ${userData.userName}`,
          type: 'success',
          timestamp: new Date().toISOString(),
          read: false,
          user: {
            name: 'System',
            avatar: 'https://ui-avatars.com/api/?name=System&background=10b981&color=fff'
          }
        };

        notifications.notifications = [newNotification, ...notifications.notifications];
        dashboard.notificationCount += 1;

      } else if (action.id === 'reset') {
        form.reset();
      }
    });

    // Simulate real-time updates
    setInterval(() => {
      // Randomly update user statuses
      const users = [...usersTable.data];
      const randomUser = users[Math.floor(Math.random() * users.length)];
      const statuses = [
        { text: 'Online', variant: 'success' },
        { text: 'Away', variant: 'warning' },
        { text: 'Busy', variant: 'error' },
        { text: 'Offline', variant: 'neutral' }
      ];

      randomUser.status = statuses[Math.floor(Math.random() * statuses.length)];
      randomUser.lastSeen = new Date().toISOString();

      usersTable.data = users;
    }, 30000); // Update every 30 seconds
  </script>
</body>
</html>
